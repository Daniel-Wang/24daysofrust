<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Day 14 - Cursive | 24 days of Rust</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="../../book/vol2/day15.html" />
    
    
    <link rel="prev" href="../../book/vol2/day13.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="2.14"
        data-chapter-title="Day 14 - Cursive"
        data-filepath="book/vol2/day14.md"
        data-basepath="../.."
        data-revision="Fri Dec 30 2016 10:05:48 GMT+0000 (UTC)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="book/vol1/index.html">
            
                
                    <a href="../../book/vol1/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Volume 1
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="book/vol1/day1.html">
            
                
                    <a href="../../book/vol1/day1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Day 1 - Cargo and crates.io
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="book/vol1/day2.html">
            
                
                    <a href="../../book/vol1/day2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Day 2 - primal
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="book/vol1/day3.html">
            
                
                    <a href="../../book/vol1/day3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        Day 3 - csv
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="book/vol1/day4.html">
            
                
                    <a href="../../book/vol1/day4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                        Day 4 - docopt
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="book/vol1/day5.html">
            
                
                    <a href="../../book/vol1/day5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.5.</b>
                        
                        Day 5 - hyper
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="book/vol1/day6.html">
            
                
                    <a href="../../book/vol1/day6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.6.</b>
                        
                        Day 6 - working with JSON
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="book/vol1/day7.html">
            
                
                    <a href="../../book/vol1/day7.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.7.</b>
                        
                        Day 7 - itertools
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="book/vol1/day8.html">
            
                
                    <a href="../../book/vol1/day8.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.8.</b>
                        
                        Day 8 - racer
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="book/vol1/day9.html">
            
                
                    <a href="../../book/vol1/day9.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.9.</b>
                        
                        Day 9 - anymap
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="book/vol1/day10.html">
            
                
                    <a href="../../book/vol1/day10.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.10.</b>
                        
                        Day 10 - the glorious tau
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="book/vol1/day11.html">
            
                
                    <a href="../../book/vol1/day11.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.11.</b>
                        
                        Day 11 - postgres
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="book/vol1/day12.html">
            
                
                    <a href="../../book/vol1/day12.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.12.</b>
                        
                        Day 12 - image
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="book/vol1/day13.html">
            
                
                    <a href="../../book/vol1/day13.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.13.</b>
                        
                        Day 13 - uuid
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="book/vol1/day14.html">
            
                
                    <a href="../../book/vol1/day14.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.14.</b>
                        
                        Day 14 - nalgebra
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="book/vol1/day15.html">
            
                
                    <a href="../../book/vol1/day15.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.15.</b>
                        
                        Day 15 - FUSE filesystems, part 1
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="book/vol1/day16.html">
            
                
                    <a href="../../book/vol1/day16.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.16.</b>
                        
                        Day 16 - FUSE filesystems, part 2
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="book/vol1/day17.html">
            
                
                    <a href="../../book/vol1/day17.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.17.</b>
                        
                        Day 17 - from_fn
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="book/vol1/day18.html">
            
                
                    <a href="../../book/vol1/day18.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.18.</b>
                        
                        Day 18 - redis
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.19" data-path="book/vol1/day19.html">
            
                
                    <a href="../../book/vol1/day19.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.19.</b>
                        
                        Day 19 - rusti
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.20" data-path="book/vol1/day20.html">
            
                
                    <a href="../../book/vol1/day20.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.20.</b>
                        
                        Day 20 - zeromq
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.21" data-path="book/vol1/day21.html">
            
                
                    <a href="../../book/vol1/day21.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.21.</b>
                        
                        Day 21 - rust-crypto
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.22" data-path="book/vol1/day22.html">
            
                
                    <a href="../../book/vol1/day22.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.22.</b>
                        
                        Day 22 - built with Rust
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.23" data-path="book/vol1/day23.html">
            
                
                    <a href="../../book/vol1/day23.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.23.</b>
                        
                        Day 23 - calling Rust from other languages
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.24" data-path="book/vol1/day24.html">
            
                
                    <a href="../../book/vol1/day24.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.24.</b>
                        
                        Day 24 - conclusion
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="book/vol2/index.html">
            
                
                    <a href="../../book/vol2/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Volume 2
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="book/vol2/day1.html">
            
                
                    <a href="../../book/vol2/day1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Day 1 - cargo subcommands
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="book/vol2/day2.html">
            
                
                    <a href="../../book/vol2/day2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Day 2 - hound
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="book/vol2/day3.html">
            
                
                    <a href="../../book/vol2/day3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Day 3 - rayon
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="book/vol2/day4.html">
            
                
                    <a href="../../book/vol2/day4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        Day 4 - structured logging
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="book/vol2/day5.html">
            
                
                    <a href="../../book/vol2/day5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                        Day 5 - environment variables
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="book/vol2/day6.html">
            
                
                    <a href="../../book/vol2/day6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.6.</b>
                        
                        Day 6 - derive_builder
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="book/vol2/day7.html">
            
                
                    <a href="../../book/vol2/day7.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.7.</b>
                        
                        Day 7 - static initialization
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="book/vol2/day8.html">
            
                
                    <a href="../../book/vol2/day8.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.8.</b>
                        
                        Day 8 - serde
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="book/vol2/day9.html">
            
                
                    <a href="../../book/vol2/day9.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.9.</b>
                        
                        Day 9 - winreg
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.10" data-path="book/vol2/day10.html">
            
                
                    <a href="../../book/vol2/day10.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.10.</b>
                        
                        Day 10 - nom, part 1
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.11" data-path="book/vol2/day11.html">
            
                
                    <a href="../../book/vol2/day11.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.11.</b>
                        
                        Day 11 - nom, part 2
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.12" data-path="book/vol2/day12.html">
            
                
                    <a href="../../book/vol2/day12.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.12.</b>
                        
                        Day 12 - clap
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.13" data-path="book/vol2/day13.html">
            
                
                    <a href="../../book/vol2/day13.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.13.</b>
                        
                        Day 13 - zip and lzma compression
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="2.14" data-path="book/vol2/day14.html">
            
                
                    <a href="../../book/vol2/day14.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.14.</b>
                        
                        Day 14 - Cursive
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.15" data-path="book/vol2/day15.html">
            
                
                    <a href="../../book/vol2/day15.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.15.</b>
                        
                        Day 15 - tera
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.16" data-path="book/vol2/day16.html">
            
                
                    <a href="../../book/vol2/day16.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.16.</b>
                        
                        Day 16 - git2
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.17" data-path="book/vol2/day17.html">
            
                
                    <a href="../../book/vol2/day17.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.17.</b>
                        
                        Day 17 - diesel
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.18" data-path="book/vol2/day18.html">
            
                
                    <a href="../../book/vol2/day18.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.18.</b>
                        
                        Day 18 - error_chain
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.19" data-path="book/vol2/day19.html">
            
                
                    <a href="../../book/vol2/day19.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.19.</b>
                        
                        Day 19 - leftpad
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.20" data-path="book/vol2/day20.html">
            
                
                    <a href="../../book/vol2/day20.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.20.</b>
                        
                        Day 20 - reqwest
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.21" data-path="book/vol2/day21.html">
            
                
                    <a href="../../book/vol2/day21.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.21.</b>
                        
                        Day 21 - app_dirs and preferences
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.22" data-path="book/vol2/day22.html">
            
                
                    <a href="../../book/vol2/day22.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.22.</b>
                        
                        Day 22 - lettre
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.23" data-path="book/vol2/day23.html">
            
                
                    <a href="../../book/vol2/day23.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.23.</b>
                        
                        Day 23 - built with Rust
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.24" data-path="book/vol2/day24.html">
            
                
                    <a href="../../book/vol2/day24.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.24.</b>
                        
                        Day 24 - conclusion
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../" >24 days of Rust</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="day-14--cursive">Day 14 - cursive</h1>
<p>My first programming IDE back in the 90s was Borland Turbo Pascal. Since
the PC that I used at that time was running MS-DOS, it meant no graphical
interface. I was so surprised when I ran <code>turbo.exe</code> for the first time
and saw complex menus, dialog windows and an editor with code highlighting.</p>
<p>But the world of TUI (text-based user interfaces) doesn&apos;t mean only IDEs.
<a href="https://www.midnight-commander.org/" target="_blank">Midnight Commander</a> is a very popular
and feature-rich file browser. There are even text-based web browsers,
such as <a href="http://lynx.invisible-island.net/" target="_blank">Lynx</a> or
<a href="http://www.elinks.cz/" target="_blank">ELinks</a>.</p>
<p>TUI applications tend to use <a href="https://en.wikipedia.org/wiki/Ncurses" target="_blank">ncurses</a>
as the abstraction layer over different terminals.
While there are Rust bindings to <code>ncurses</code>, there&apos;s another cool library built
on top of them. <a href="https://crates.io/crates/cursive" target="_blank"><code>Cursive</code></a> provides
high-level building blocks such as views, menus and layers. It also works
on Windows, when built with <code>features = [&quot;pancurses&quot;]</code>.</p>
<h2 id="application-setup">Application setup</h2>
<p>Every application using <code>Cursive</code> needs an event loop, implemented as the
<code>Cursive::run()</code> method. The example below shows a simple &quot;Hello World&quot;
program with <code>Cursive</code>:</p>
<pre><code class="lang-rust"><span class="hljs-keyword">extern</span> <span class="hljs-keyword">crate</span> cursive;

<span class="hljs-keyword">use</span> cursive::Cursive;
<span class="hljs-keyword">use</span> cursive::views::TextView;

<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span></span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> app = Cursive::new();
    app.add_layer(TextView::new(<span class="hljs-string">&quot;Hello Rust&quot;</span>));
    app.add_global_callback(<span class="hljs-string">&apos;q&apos;</span>, |a| a.quit());
    app.run();
}
</code></pre>
<p>The <code>TextView</code> is one of the simplest views in <code>Cursive</code>. You can set the
text directly in <code>new()</code> or later with <code>set_content()</code>. To quit our program,
the user has to press the <code>q</code> key which triggers a global callback (the
argument passed to callback is the <code>Cursive</code> object itself).</p>
<p>Let&apos;s run it!</p>
<p><img src="http://wstaw.org/m/2016/12/14/hello.png" alt=""></p>
<h2 id="file-browser">File browser</h2>
<p>We&apos;re going to build a very minimalistic file browser with preview for text
files. Let&apos;s start with describing a general layout of the interface:</p>
<pre><code class="lang-rust"><span class="hljs-keyword">extern</span> <span class="hljs-keyword">crate</span> cursive;

<span class="hljs-keyword">use</span> cursive::Cursive;
<span class="hljs-keyword">use</span> cursive::traits::*;
<span class="hljs-keyword">use</span> cursive::views::{Dialog, DummyView, LinearLayout, SelectView, TextView};

<span class="hljs-keyword">use</span> std::fs::{<span class="hljs-keyword">self</span>, DirEntry, File};
<span class="hljs-keyword">use</span> std::io::Read;
<span class="hljs-keyword">use</span> std::path::Path;

<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">main</span></span>() {
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> app = Cursive::new();
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> panes = LinearLayout::horizontal();
    <span class="hljs-keyword">let</span> picker = file_picker(<span class="hljs-string">&quot;.&quot;</span>);
    panes.add_child(picker.fixed_size((<span class="hljs-number">30</span>, <span class="hljs-number">25</span>)));
    panes.add_child(DummyView);
    panes.add_child(TextView::new(<span class="hljs-string">&quot;file contents&quot;</span>)
        .with_id(<span class="hljs-string">&quot;contents&quot;</span>)
        .fixed_size((<span class="hljs-number">50</span>, <span class="hljs-number">25</span>)));
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> layout = LinearLayout::vertical();
    layout.add_child(panes);
    layout.add_child(TextView::new(<span class="hljs-string">&quot;status&quot;</span>)
        .scrollable(<span class="hljs-keyword">false</span>)
        .with_id(<span class="hljs-string">&quot;status&quot;</span>)
        .fixed_size((<span class="hljs-number">80</span>, <span class="hljs-number">1</span>)));
    app.add_layer(Dialog::around(layout).button(<span class="hljs-string">&quot;Quit&quot;</span>, |a| a.quit()));
    app.run();
}
</code></pre>
<p>Here&apos;s our file browser displaying contents of <code>Cargo.lock</code>:</p>
<p><img src="http://wstaw.org/m/2016/12/14/browser.png" alt=""></p>
<p>The app consists of two vertical panes with a status bar below and a <em>Quit</em>
button in the bottom right corner. Left pane contains a file picker. On the
right there is a <code>TextView</code> to show preview of the selected file.
The <code>DummyView</code> acts only as a separator. Note the <code>with_id()</code> calls.
We give textual IDs to some controls so that we can find them later from
inside the event handlers.</p>
<p>And now the directory listing:</p>
<pre><code class="lang-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">file_picker</span></span>&lt;D&gt;(directory: D) -&gt; SelectView&lt;DirEntry&gt;
    <span class="hljs-keyword">where</span> D: <span class="hljs-built_in">AsRef</span>&lt;Path&gt;
{
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> view = SelectView::new();
    <span class="hljs-keyword">for</span> entry <span class="hljs-keyword">in</span> fs::read_dir(directory).expect(<span class="hljs-string">&quot;can&apos;t read directory&quot;</span>) {
        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-built_in">Ok</span>(e) = entry {
            <span class="hljs-keyword">let</span> file_name = e.file_name().into_string().unwrap();
            view.add_item(file_name, e);
        }
    }
    view.on_select(update_status).on_submit(load_contents)
}
</code></pre>
<p>The file picker returns a <code>SelectView</code> which is a list of items (directory
entries in this example). There are two events that can happen here. The user
can select an item (by navigating with arrow keys) or they can press Enter
to run the callback registered in <code>on_submit</code>. Here are the event handlers
for both of these events:</p>
<pre><code class="lang-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">update_status</span></span>(app: &amp;<span class="hljs-keyword">mut</span> Cursive, entry: &amp;DirEntry) {
    <span class="hljs-keyword">let</span> status_bar = app.find_id::&lt;TextView&gt;(<span class="hljs-string">&quot;status&quot;</span>).unwrap();
    <span class="hljs-keyword">let</span> file_name = entry.file_name().into_string().unwrap();
    <span class="hljs-keyword">let</span> file_size = entry.metadata().unwrap().len();
    <span class="hljs-keyword">let</span> content = <span class="hljs-built_in">format!</span>(<span class="hljs-string">&quot;{}: {} bytes&quot;</span>, file_name, file_size);
    status_bar.set_content(content);
}

<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">load_contents</span></span>(app: &amp;<span class="hljs-keyword">mut</span> Cursive, entry: &amp;DirEntry) {
    <span class="hljs-keyword">let</span> text_view = app.find_id::&lt;TextView&gt;(<span class="hljs-string">&quot;contents&quot;</span>).unwrap();
    <span class="hljs-keyword">let</span> content = <span class="hljs-keyword">if</span> entry.metadata().unwrap().is_dir() {
        <span class="hljs-string">&quot;&lt;DIR&gt;&quot;</span>.to_string()
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut</span> buf = String::new();
        <span class="hljs-keyword">let</span> _ = File::open(entry.file_name())
            .and_then(|<span class="hljs-keyword">mut</span> f| f.read_to_string(&amp;<span class="hljs-keyword">mut</span> buf))
            .map_err(|e| buf = <span class="hljs-built_in">format!</span>(<span class="hljs-string">&quot;Error: {}&quot;</span>, e));
        buf
    };
    text_view.set_content(content);
}
</code></pre>
<p>When the user selects a file, the status bar updates to show its name and size.
If the user presses Enter on a file, the preview pane changes its contents.
Each of the callbacks takes a <code>Cursive</code> object and an item from the
<code>SelectView</code> which caused the event. We&apos;re using <code>Cursive::find_id()</code>
to find controls by their IDs defined in the application layout.</p>
<p>There are several possible things to improve here:</p>
<ul>
<li>change into selected directory instead of showing <code>&lt;DIR&gt;</code></li>
<li>skip preview for binary files</li>
<li>avoid panics on errors - most of these <code>unwrap()</code> calls should be replaced
with proper error handling. <code>load_contents()</code> attempts that when reading
file contents, but not anywhere else.</li>
</ul>
<h2 id="further-reading">Further reading</h2>
<ul>
<li><a href="http://www.linuxplanet.com/linuxplanet/reviews/6964/1" target="_blank">Discovering ncurses, the GUI for the Linux Console</a></li>
<li><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2655855/" target="_blank">Comparing Text-based and Graphic User Interfaces for Novice and Expert Users</a></li>
<li><a href="http://urwid.org/" target="_blank">Urwid</a> - a console UI framework (for Python)</li>
<li><a href="https://crates.io/crates/rustbox" target="_blank">rustbox</a> - a Rust wrapper for <a href="https://github.com/nsf/termbox" target="_blank">termbox</a></li>
</ul>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../book/vol2/day13.html" class="navigation navigation-prev " aria-label="Previous page: Day 13 - zip and lzma compression"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../book/vol2/day15.html" class="navigation navigation-next " aria-label="Next page: Day 15 - tera"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../gitbook/app.js"></script>

    
    <script src="../../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"include-codeblock":{},"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
